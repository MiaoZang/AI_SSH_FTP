import{d as ie,k as c,c as K,D as re,a as d,b as l,e as t,w as n,g as b,h as i,v as ue,u as x,G as P,i as v,t as u,T as ce,p as w,x as E,F as U,r as W,H as F,I as de,j as G,E as _,_ as ve}from"./index-x4DXS2Vx.js";import{c as H}from"./cardKey-QBtV7CK8.js";import"./index-j8vyhiJM.js";import"./index-B9ygI19o.js";const me={class:"activation-page"},pe={class:"input-section"},fe={key:0,class:"error-content"},be={key:1,class:"card-info-container"},ye={key:0,class:"countdown-section"},_e={class:"info-section"},he={class:"label"},ge={class:"value"},we={key:1,class:"info-section"},Ae={class:"section-title-row"},Ce={class:"label"},ke={class:"value"},xe={class:"action-row"},ze={class:"batch-section"},Me={class:"batch-config"},Te={class:"delimiter-input"},$e={key:0,class:"batch-results"},Ne={class:"results-header"},Ve={class:"summary-text"},De={class:"total"},Ye={class:"success"},Fe={class:"fail"},Xe={key:0,class:"compact-info"},Se={key:1,class:"error-msg"},Be={class:"batch-footer"},Ie=ie({__name:"CardActivation",setup(Le){const X=c("single"),z=c(""),p=c(!1),$=c(!1),M=c(!1),D=c(""),A=c(null),f=c(null),Y=c(""),C=c("-"),h=c([]),S=K(()=>h.value.filter(a=>a.success).length),j=K(()=>h.value.filter(a=>!a.success).length),T=c(null),g=c("");let m=null;const B=()=>{if(!T.value){g.value="";return}const a=new Date,o=new Date(T.value.getTime()+3600*1e3).getTime()-a.getTime();if(o<=0){g.value="å·²è¿‡æœŸ",m&&(clearInterval(m),m=null);return}const y=Math.floor(o/(1e3*60)),r=Math.floor(o%(1e3*60)/1e3);g.value=`${y}åˆ†${r}ç§’`},O=()=>{m&&clearInterval(m),B(),m=setInterval(B,1e3)};re(()=>{m&&clearInterval(m)});const Z=()=>{const a=["James","Mary","Robert","Patricia","John","Jennifer","Michael","Linda","William","Elizabeth","David","Barbara","Richard","Susan","Joseph","Jessica","Thomas","Sarah","Charles","Karen"],e=["Smith","Johnson","Williams","Brown","Jones","Garcia","Miller","Davis","Rodriguez","Martinez","Hernandez","Lopez","Gonzales","Wilson","Anderson","Thomas","Taylor","Moore","Jackson","Martin"],o=a[Math.floor(Math.random()*a.length)],y=e[Math.floor(Math.random()*e.length)];return`${o} ${y}`},I=()=>{const a=[{city:"New York",stateFull:"New York",stateAbbr:"NY",zip:"10001"},{city:"Los Angeles",stateFull:"California",stateAbbr:"CA",zip:"90001"},{city:"Chicago",stateFull:"Illinois",stateAbbr:"IL",zip:"60601"},{city:"Houston",stateFull:"Texas",stateAbbr:"TX",zip:"77001"},{city:"Phoenix",stateFull:"Arizona",stateAbbr:"AZ",zip:"85001"},{city:"Philadelphia",stateFull:"Pennsylvania",stateAbbr:"PA",zip:"19101"},{city:"San Antonio",stateFull:"Texas",stateAbbr:"TX",zip:"78201"},{city:"San Diego",stateFull:"California",stateAbbr:"CA",zip:"92101"},{city:"Dallas",stateFull:"Texas",stateAbbr:"TX",zip:"75201"},{city:"Denver",stateFull:"Colorado",stateAbbr:"CO",zip:"80201"}],e=["Main St","Oak Ave","Washington Blvd","Lakeview Dr","Parkway Dr","Lexington Ave","Broadway","Sunset Blvd","Lincoln Ave","Madison St"],o=a[Math.floor(Math.random()*a.length)],y=Math.floor(Math.random()*9e3)+100,r=e[Math.floor(Math.random()*e.length)];return{name:Z(),street:`${y} ${r}`,city:o.city,stateFull:o.stateFull,stateAbbr:o.stateAbbr,zip:o.zip}},q=()=>{f.value=I(),_.success("è´¦å•åœ°å€å·²é‡æ–°ç”Ÿæˆ")},N=async a=>{try{await navigator.clipboard.writeText(a),_.success("å·²å¤åˆ¶åˆ°å‰ªè´´æ¿")}catch{const e=document.createElement("textarea");e.value=a,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),_.success("å·²å¤åˆ¶åˆ°å‰ªè´´æ¿")}},L=async()=>{if(!z.value.trim()){_.warning("è¯·è¾“å…¥å¡å¯†");return}p.value=!0,$.value=!1;try{const a=await H.internalActivateByCode(z.value.trim());a.success&&a.card?(M.value=!0,A.value={cardNumber:a.card.cardNumber||"****************",expiry:a.card.expiryDate||"MM/YY",cvv:a.card.cvv||"***"},f.value=I(),a.activatedAt?T.value=new Date(a.activatedAt):T.value=new Date,O(),_.success("æ¿€æ´»æˆåŠŸï¼")):(M.value=!1,D.value="æ¿€æ´»å¤±è´¥")}catch(a){M.value=!1,D.value=a.response?.data?.error||a.message||"ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åŽé‡è¯•"}finally{p.value=!1,$.value=!0}},Q=async()=>{const a=Y.value.split(`
`).map(e=>e.trim()).filter(e=>e.length>0);if(a.length===0){_.warning("è¯·è¾“å…¥è‡³å°‘ä¸€ä¸ªå¡å¯†");return}p.value=!0;try{const e=await H.batchActivateByCodes(a,!0);h.value=e.results,e.successCount>0?_.success(`æ“ä½œå®Œæˆï¼š${e.successCount} ä¸ªæˆåŠŸï¼Œ${e.failCount} ä¸ªå¤±è´¥`):_.error("å…¨éƒ¨æ¿€æ´»å¤±è´¥")}catch(e){_.error(e.response?.data?.error||"æ‰¹é‡æ“ä½œå¤±è´¥")}finally{p.value=!1}},ee=()=>{const a=h.value.filter(e=>e.success&&e.card).map(e=>`${e.card.cardNumber}${C.value}${e.card.expiryDate}${C.value}${e.card.cvv}`);a.length!==0&&N(a.join(`
`))},J=()=>{z.value="",$.value=!1,A.value=null,f.value=null,T.value=null,g.value="",m&&(clearInterval(m),m=null)};return(a,e)=>{const o=b("el-icon"),y=b("el-input"),r=b("el-button"),te=b("el-alert"),ae=b("el-divider"),R=b("el-tab-pane"),V=b("el-table-column"),se=b("el-tag"),le=b("el-table"),ne=b("el-tabs");return i(),d("div",me,[e[21]||(e[21]=l("div",{class:"page-header"},[l("h1",null,"ðŸŽ« å¡å¯†æ¿€æ´»"),l("p",null,"è¾“å…¥å¡å¯†ï¼Œæ¿€æ´»èŽ·å–å¡ç‰‡ä¿¡æ¯")],-1)),t(ne,{modelValue:X.value,"onUpdate:modelValue":e[4]||(e[4]=s=>X.value=s),class:"activation-tabs",type:"border-card"},{default:n(()=>[t(R,{label:"å¸¸ç”¨æ¿€æ´»",name:"single"},{default:n(()=>[l("div",pe,[t(y,{modelValue:z.value,"onUpdate:modelValue":e[0]||(e[0]=s=>z.value=s),placeholder:"è¯·è¾“å…¥å¡å¯†...",size:"large",disabled:p.value,onKeyup:ue(L,["enter"]),class:"card-key-input"},{prefix:n(()=>[t(o,null,{default:n(()=>[t(x(P))]),_:1})]),_:1},8,["modelValue","disabled"]),t(r,{type:"primary",size:"large",loading:p.value,onClick:L,class:"activate-btn"},{default:n(()=>[v(u(p.value?"æ¿€æ´»ä¸­...":"æ¿€æ´»"),1)]),_:1},8,["loading"])]),t(ce,{name:"fade"},{default:n(()=>[$.value?(i(),d("div",{key:0,class:E(["result-container",M.value?"success":"error"])},[M.value?A.value?(i(),d("div",be,[g.value?(i(),d("div",ye,[e[6]||(e[6]=l("span",{class:"countdown-label"},"â±ï¸ å¡å¯†æœ‰æ•ˆæœŸå‰©ä½™ï¼š",-1)),l("span",{class:E(["countdown-value",g.value==="å·²è¿‡æœŸ"?"expired":""])},u(g.value),3)])):w("",!0),l("div",_e,[e[7]||(e[7]=l("div",{class:"section-title-row"},[l("span",{class:"section-title"},"å¡ç‰‡ä¿¡æ¯")],-1)),(i(!0),d(U,null,W({å¡å·:A.value.cardNumber,æœ‰æ•ˆæœŸ:A.value.expiry,CVV:A.value.cvv},(s,k)=>(i(),d("div",{class:"info-item",key:k},[l("span",he,u(k),1),l("span",ge,u(s),1),t(r,{size:"small",text:"",type:"primary",onClick:oe=>N(s)},{default:n(()=>[t(o,null,{default:n(()=>[t(x(F))]),_:1})]),_:1},8,["onClick"])]))),128))]),t(ae),f.value?(i(),d("div",we,[l("div",Ae,[e[9]||(e[9]=l("span",{class:"section-title"},"è´¦å•åœ°å€ (éšæœºç”Ÿæˆ)",-1)),t(r,{size:"small",type:"primary",link:"",onClick:q},{default:n(()=>[t(o,null,{default:n(()=>[t(x(de))]),_:1}),e[8]||(e[8]=v(" é‡æ–°éšæœº ",-1))]),_:1})]),(i(!0),d(U,null,W({å§“å:f.value.name,è¡—é“:f.value.street,åŸŽå¸‚:f.value.city,"å·ž/çœ":f.value.stateFull,å·žç¼©å†™:f.value.stateAbbr,é‚®ç¼–:f.value.zip},(s,k)=>(i(),d("div",{class:"info-item",key:k},[l("span",Ce,u(k),1),l("span",ke,u(s),1),t(r,{size:"small",text:"",type:"primary",onClick:oe=>N(s)},{default:n(()=>[t(o,null,{default:n(()=>[t(x(F))]),_:1})]),_:1},8,["onClick"])]))),128))])):w("",!0),l("div",xe,[t(r,{onClick:J},{default:n(()=>[...e[10]||(e[10]=[v("æ¸…ç©ºé‡ç½®",-1)])]),_:1})])])):w("",!0):(i(),d("div",fe,[t(te,{title:D.value,type:"danger","show-icon":"",closable:!1},null,8,["title"]),t(r,{type:"primary",class:"retry-btn",onClick:J},{default:n(()=>[...e[5]||(e[5]=[v("é‡è¯•",-1)])]),_:1})]))],2)):w("",!0)]),_:1})]),_:1}),t(R,{label:"æ‰¹é‡æ¿€æ´»",name:"batch"},{default:n(()=>[l("div",ze,[e[20]||(e[20]=l("p",{class:"batch-tip"},"è¯·è¾“å…¥å¡å¯†åˆ—è¡¨ï¼Œä¸€è¡Œä¸€ä¸ªï¼š",-1)),t(y,{modelValue:Y.value,"onUpdate:modelValue":e[1]||(e[1]=s=>Y.value=s),type:"textarea",rows:6,placeholder:`AAA0-XXXX-XXXX-XXXX
AAA0-YYYY-YYYY-YYYY`,disabled:p.value},null,8,["modelValue","disabled"]),l("div",Me,[l("div",Te,[e[11]||(e[11]=l("span",{class:"label"},"åˆ†éš”ç¬¦ï¼š",-1)),t(y,{modelValue:C.value,"onUpdate:modelValue":e[2]||(e[2]=s=>C.value=s),style:{width:"80px"},size:"default"},null,8,["modelValue"])]),t(r,{type:"primary",size:"large",loading:p.value,onClick:Q,class:"batch-btn"},{default:n(()=>[p.value?w("",!0):(i(),G(o,{key:0},{default:n(()=>[t(x(P))]),_:1})),e[12]||(e[12]=v(" æ‰¹é‡æ¿€æ´» ",-1))]),_:1},8,["loading"])]),h.value.length>0?(i(),d("div",$e,[l("div",Ne,[e[16]||(e[16]=l("h3",null,"å¤„ç†ç»“æžœæ±‡æ€»",-1)),l("p",Ve,[e[13]||(e[13]=v(" æ€»è®¡: ",-1)),l("span",De,u(h.value.length),1),e[14]||(e[14]=v(" | æˆåŠŸ: ",-1)),l("span",Ye,u(S.value),1),e[15]||(e[15]=v(" | å¤±è´¥: ",-1)),l("span",Fe,u(j.value),1)])]),t(le,{data:h.value,border:"",stripe:"",style:{width:"100%"},"max-height":"400"},{default:n(()=>[t(V,{prop:"keyCode",label:"å¡å¯†","min-width":"180","show-overflow-tooltip":""}),t(V,{label:"çŠ¶æ€",width:"100",align:"center"},{default:n(s=>[t(se,{type:s.row.success?"success":"danger",size:"small"},{default:n(()=>[v(u(s.row.success?"æˆåŠŸ":"å¤±è´¥"),1)]),_:2},1032,["type"])]),_:1}),t(V,{label:"è¯¦æƒ…","min-width":"240"},{default:n(s=>[s.row.success&&s.row.card?(i(),d("div",Xe,[l("code",null,u(s.row.card.cardNumber)+" | "+u(s.row.card.expiryDate)+" | "+u(s.row.card.cvv),1)])):(i(),d("div",Se,u(s.row.error),1))]),_:1}),t(V,{label:"æ“ä½œ",width:"80",align:"center"},{default:n(s=>[s.row.success?(i(),G(r,{key:0,size:"small",type:"primary",link:"",onClick:k=>N(`${s.row.card.cardNumber}${C.value}${s.row.card.expiryDate}${C.value}${s.row.card.cvv}`)},{default:n(()=>[...e[17]||(e[17]=[v(" å¤åˆ¶ ",-1)])]),_:1},8,["onClick"])):w("",!0)]),_:1})]),_:1},8,["data"]),l("div",Be,[t(r,{onClick:ee,type:"success",disabled:S.value===0},{default:n(()=>[t(o,null,{default:n(()=>[t(x(F))]),_:1}),e[18]||(e[18]=v(" å¤åˆ¶å…¨éƒ¨æˆåŠŸä¿¡æ¯ ",-1))]),_:1},8,["disabled"]),t(r,{onClick:e[3]||(e[3]=s=>h.value=[]),plain:""},{default:n(()=>[...e[19]||(e[19]=[v("æ¸…ç©ºåˆ—è¡¨",-1)])]),_:1})])])):w("",!0)])]),_:1})]),_:1},8,["modelValue"])])}}}),Ee=ve(Ie,[["__scopeId","data-v-45d06242"]]);export{Ee as default};

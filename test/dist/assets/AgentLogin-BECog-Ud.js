import{d as h,k as c,J as V,a as k,b as n,e as o,w as t,v as x,g as r,f as b,h as S,i as A,t as B,E as m,_ as C}from"./index-x4DXS2Vx.js";import{a as E}from"./index-B9ygI19o.js";const I={class:"agent-login"},L={class:"login-container"},N=h({__name:"AgentLogin",setup(z){const f=b(),d=c(),s=c(!1),a=V({username:"",password:""}),g={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},_="/api/v1";async function u(){if(await d.value?.validate().catch(()=>!1)){s.value=!0;try{const e=await E.post(`${_}/agent/login`,a);localStorage.setItem("agent_token",e.data.token),localStorage.setItem("agent_info",JSON.stringify(e.data.agent)),m.success("登录成功"),f.push("/agent")}catch(e){m.error(e.response?.data?.error||"登录失败")}finally{s.value=!1}}}return(v,e)=>{const p=r("el-input"),l=r("el-form-item"),w=r("el-button"),y=r("el-form");return S(),k("div",I,[n("div",L,[e[2]||(e[2]=n("div",{class:"login-header"},[n("h1",null,"代理登录"),n("p",null,"虚拟卡分销管理系统")],-1)),o(y,{ref_key:"formRef",ref:d,model:a,rules:g,class:"login-form",onKeyup:x(u,["enter"])},{default:t(()=>[o(l,{prop:"username"},{default:t(()=>[o(p,{modelValue:a.username,"onUpdate:modelValue":e[0]||(e[0]=i=>a.username=i),placeholder:"请输入用户名","prefix-icon":"User",size:"large"},null,8,["modelValue"])]),_:1}),o(l,{prop:"password"},{default:t(()=>[o(p,{modelValue:a.password,"onUpdate:modelValue":e[1]||(e[1]=i=>a.password=i),type:"password",placeholder:"请输入密码","prefix-icon":"Lock",size:"large","show-password":""},null,8,["modelValue"])]),_:1}),o(l,null,{default:t(()=>[o(w,{type:"primary",size:"large",class:"login-button",loading:s.value,onClick:u},{default:t(()=>[A(B(s.value?"登录中...":"登 录"),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])])}}}),q=C(N,[["__scopeId","data-v-d55f4640"]]);export{q as default};

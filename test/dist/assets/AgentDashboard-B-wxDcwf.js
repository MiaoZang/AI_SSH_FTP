import{d as N,k as K,c as z,o as C,a as D,b as s,e,w as a,E as x,g as d,h,u as _,W as V,t as u,X as A,Y as B,i as p,K as I,V as M,j as $,p as E,_ as F}from"./index-x4DXS2Vx.js";import{a as J}from"./agentApi-CTrSVxho.js";import"./index-B9ygI19o.js";const O={class:"agent-dashboard"},R={class:"stat-content"},j={class:"stat-icon"},q={class:"stat-info"},L={class:"stat-value"},P={class:"stat-content"},T={class:"stat-icon total"},W={class:"stat-info"},X={class:"stat-value"},Y={class:"stat-content"},G={class:"stat-icon used"},H={class:"stat-info"},Q={class:"stat-value"},U={class:"actions-container"},Z={class:"usage-stats"},tt={class:"usage-item"},et={class:"count"},st={class:"usage-item"},at={class:"count"},ot={class:"amount-positive"},nt=N({__name:"AgentDashboard",setup(lt){const n=K(null),f=z(()=>{const o=n.value?.cardKeyStats?.total||0;if(o===0)return{used:0,unused:0};const t=n.value?.cardKeyStats?.used||0,l=n.value?.cardKeyStats?.unused||0;return{used:Math.round(t/o*100),unused:Math.round(l/o*100)}});async function y(){try{const o=await J.get("/agent/dashboard");n.value=o.data;const t=localStorage.getItem("agent_info");if(t){const l=JSON.parse(t);l.balance=o.data.balance,localStorage.setItem("agent_info",JSON.stringify(l))}}catch(o){x.error(o.response?.data?.error||"获取数据失败")}}function k(o){return o?new Date(o).toLocaleString("zh-CN"):"-"}return C(()=>{y()}),(o,t)=>{const l=d("el-icon"),r=d("el-card"),c=d("el-col"),v=d("el-row"),m=d("el-button"),g=d("el-progress"),b=d("el-table-column"),S=d("el-table"),w=d("el-empty");return h(),D("div",O,[t[12]||(t[12]=s("h2",null,"仪表盘",-1)),e(v,{gutter:20,class:"stats-row"},{default:a(()=>[e(c,{span:8},{default:a(()=>[e(r,{class:"stat-card balance-card"},{default:a(()=>[s("div",R,[s("div",j,[e(l,{size:40},{default:a(()=>[e(_(V))]),_:1})]),s("div",q,[s("div",L,"¥"+u(Number(n.value?.balance||0).toFixed(2)),1),t[2]||(t[2]=s("div",{class:"stat-label"},"账户余额",-1))])])]),_:1})]),_:1}),e(c,{span:8},{default:a(()=>[e(r,{class:"stat-card"},{default:a(()=>[s("div",P,[s("div",T,[e(l,{size:40},{default:a(()=>[e(_(A))]),_:1})]),s("div",W,[s("div",X,u(n.value?.cardKeyStats?.total||0),1),t[3]||(t[3]=s("div",{class:"stat-label"},"卡密总数",-1))])])]),_:1})]),_:1}),e(c,{span:8},{default:a(()=>[e(r,{class:"stat-card"},{default:a(()=>[s("div",Y,[s("div",G,[e(l,{size:40},{default:a(()=>[e(_(B))]),_:1})]),s("div",H,[s("div",Q,u(n.value?.cardKeyStats?.used||0),1),t[4]||(t[4]=s("div",{class:"stat-label"},"已使用",-1))])])]),_:1})]),_:1})]),_:1}),e(r,{class:"quick-actions"},{header:a(()=>[...t[5]||(t[5]=[s("span",null,"快捷操作",-1)])]),default:a(()=>[s("div",U,[e(m,{type:"primary",size:"large",onClick:t[0]||(t[0]=i=>o.$router.push("/agent/card-keys"))},{default:a(()=>[e(l,null,{default:a(()=>[e(_(I))]),_:1}),t[6]||(t[6]=p(" 生成卡密 ",-1))]),_:1}),e(m,{size:"large",onClick:t[1]||(t[1]=i=>o.$router.push("/agent/bills"))},{default:a(()=>[e(l,null,{default:a(()=>[e(_(M))]),_:1}),t[7]||(t[7]=p(" 查看账单 ",-1))]),_:1})])]),_:1}),e(v,{gutter:20},{default:a(()=>[e(c,{span:12},{default:a(()=>[e(r,null,{header:a(()=>[...t[8]||(t[8]=[s("span",null,"卡密使用情况",-1)])]),default:a(()=>[s("div",Z,[s("div",tt,[t[9]||(t[9]=s("span",{class:"label"},"未使用",-1)),e(g,{percentage:f.value.unused,"stroke-width":20,color:"#409eff"},null,8,["percentage"]),s("span",et,u(n.value?.cardKeyStats?.unused||0)+" 张",1)]),s("div",st,[t[10]||(t[10]=s("span",{class:"label"},"已使用",-1)),e(g,{percentage:f.value.used,"stroke-width":20,color:"#67c23a"},null,8,["percentage"]),s("span",at,u(n.value?.cardKeyStats?.used||0)+" 张",1)])])]),_:1})]),_:1}),e(c,{span:12},{default:a(()=>[e(r,null,{header:a(()=>[...t[11]||(t[11]=[s("span",null,"最近充值记录",-1)])]),default:a(()=>[e(S,{data:n.value?.recentRecharges||[],size:"small"},{default:a(()=>[e(b,{prop:"amount",label:"金额"},{default:a(({row:i})=>[s("span",ot,"+¥"+u(Number(i.amount).toFixed(2)),1)]),_:1}),e(b,{label:"时间"},{default:a(({row:i})=>[p(u(k(i.createdAt)),1)]),_:1})]),_:1},8,["data"]),n.value?.recentRecharges?.length?E("",!0):(h(),$(w,{key:0,description:"暂无充值记录"}))]),_:1})]),_:1})]),_:1})])}}}),ct=F(nt,[["__scopeId","data-v-2560aa87"]]);export{ct as default};
